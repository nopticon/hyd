RewriteEngine on

RewriteCond %{QUERY_STRING} base64_encode.*\(.*\) [OR]
RewriteCond %{QUERY_STRING} GLOBALS(=|\[|\%[0-9A-Z]{0,2}) [OR]
RewriteCond %{QUERY_STRING} _REQUEST(=|\[|\%[0-9A-Z]{0,2})
RewriteRule ^.*$ - [R=404,L]

RewriteCond %{HTTP_HOST} ^(w3|www)?(.)?rkradio
RewriteRule ^(.*)$ http://www.rockrepublik.net/broadcast/$1 [R=301,L]

RewriteCond %{HTTP_HOST} ^w3.(rockrepublik|rockrepublica|rockrepublick)
RewriteRule ^(.*)$ http://www.rockrepublik.net/$1 [R=301,L]

RewriteCond %{HTTP_HOST} !^www\.(rock|rk)
RewriteCond %{HTTP_HOST} ^(www\.)?([a-z0-9]+)\.(rock|rk)
RewriteRule ^([0-9]+)/ps([0-9]+)/$ orion/artists.php?id=%2&layout=$1&ps=$2 [L]

RewriteCond %{HTTP_HOST} !^www\.(rock|rk)
RewriteCond %{HTTP_HOST} ^(www\.)?([a-z0-9]+)\.(rock|metal|rk)
RewriteRule ^([^.]+)?$ orion/artists.php?id=%2&layout=$1 [L]

RewriteRule ^$ orion/home.php [nc]
RewriteRule ^(education|awards|board|emoticons|community|comments|search|ssv|tos|allies|broadcast|acp)/?$ orion/$1.php [nc]
RewriteRule ^(acp|async|cron|news)/([a-z\_]+)/(([0-9a-z\_\.\-\:]+)/?)?$ orion/$1.php?module=$2&args=$4 [nc]
RewriteRule ^today/?$ orion/unread.php [nc]
RewriteRule ^(sign)(in|out|up|r)/?$ orion/$1.php?mode=$2 [nc]
RewriteRule ^(sign)(up|r)/([a-z0-9]+)/$ orion/$1.php?mode=$2&code=$3 [nc]
RewriteRule ^(sign)(up)/v/([0-9a-z]+)/$ orion/$1.php?mode=$2&invite=$1 [nc]

RewriteRule ^(events)/g([0-9]+)/$ orion/$1.php?gallery_offset=$2 [nc]
RewriteRule ^(events)/([0-9a-z\-]+)/(\d+)/reply/$ orion/$1.php?alias=$2&p=$3&reply=1 [nc]
RewriteRule ^(events)/([0-9a-z\-]+)/([0-9]+)/(view|save|fav|rsvp)/$ orion/$1.php?alias=$2&download_id=$3&mode=$4 [nc]
RewriteRule ^(events)/?(([0-9a-z\-]+)/?(s([0-9]+)/)?(ps([0-9]+)/)?)?$ orion/$1.php?alias=$3&offset=$5&ps=$7 [nc]
RewriteRule ^forum/([a-z0-9]+)/?(s([0-9]+)/)?$ orion/topics.php?f=$1&offset=$3 [L]
RewriteRule ^(help)/([0-9]+)/?$ orion/$1.php?help=$2 [nc]
RewriteRule ^(help)/?(([0-9a-z]+)/?)?$ orion/$1p.php?module=$3 [nc]
RewriteRule ^(news)/?(([0-9a-z\_\-]+)/?(ps([0-9]+)/)?)?$ orion/$1.php?alias=$3&ps=$5 [nc]
RewriteRule ^broadcast/(.*?)/$ orion/broadcast.php?category=$1 [nc]
RewriteRule ^post/([0-9]+)/reply/$ orion/topic.php?p=$1&reply=1 [nc]
RewriteRule ^post/([0-9]+)/?$ orion/topic.php?p=$1 [nc]
RewriteRule ^(topic)/([0-9]+)/?(s([0-9]+)/?)?$ orion/$1.php?t=$2&offset=$4 [nc]
RewriteRule ^rss/(artists|events|forum|news)/?$ orion/rss.php?mode=$1 [nc]
RewriteRule ^play/([0-9]+)\-([0-9]+)\.mp3$ http://artists.rockrepublik.net/$1/media/$2.mp3 [nc]

RewriteRule ^a/?(_([0-9]+)/?)?$ orion/artists.php?alphabet=$2 [nc]
RewriteRule ^a/([0-9a-z]+)/(4|6)/([0-9]+)/(view|save)/$ orion/artists.php?id=$1&layout=$2&download_id=$3&mode=$4 [nc]
RewriteRule ^a/([0-9a-z]+)/9/([0-9]+)/((([a-z]+)/)?(dps([0-9]+)/)?)?$ orion/artists.php?id=$1&layout=9&download_id=$2&dl_mode=$5&dps=$7 [nc]
RewriteRule ^a/([0-9a-z]+)/12/([0-9]+)/(([a-z]+)/)?(rs([0-9]+)/)?$ orion/artists.php?id=$1&layout=12&post_id=$2&mode=$4&rs=$6 [nc]
RewriteRule ^a/([0-9a-z]+)/16/(t|p)([0-9]+)/$ orion/artists.php?id=$1&layout=16&$2=$3 [nc]
RewriteRule ^a/([0-9a-z]+)/((([0-9]+)/)?((gs|ps)([0-9]+)/)?)?$ orion/artists.php?id=$1&layout=$4&$6=$7 [nc]
RewriteRule ^a/([0-9a-z]+)(/?([0-9]+)/?)?$ orion/artists.php?id=$1&layout=$3 [nc]

RewriteRule ^m/([0-9a-z\_\-]+)/?((main|friend|friends|messages|ban)/?)?$ orion/userpage.php?member=$1&mode=$3 [nc]
RewriteRule ^my/(profile)/?$ orion/userpage.php [nc]
RewriteRule ^my/(dc)/(start)/?(([0-9a-zA-Z\_\-]+)/)?$ orion/userpage.php?page=$1&action=$2&member=$4 [nc]
RewriteRule ^my/(dc)/([a-z]+)/([0-9]+)/$ orion/userpage.php?page=$1&mode=$2&p=$3 [nc]
RewriteRule ^my/(dc)/?(s([0-9]+)/)?$ orion/userpage.php?page=$1&offset=$3 [nc]

AddType audio/x-scpls pls
AddType audio/x-mpegurl m3u
AddType application/vnd.ms-asf asx

<IfModule mod_expires.c>
ExpiresActive On
ExpiresByType image/gif "access plus 1 month"
ExpiresByType image/jpeg "access plus 1 month"
ExpiresByType image/png "access plus 1 month"

FileETag MTime Size
</IfModule>
